
@{
    ViewBag.Title = "MyDiary";
}


<!DOCTYPE html>
<html>
<head>
    <title>Timeline</title>
    <link href="/Content/MyDiary_Time/font-awesome.4.6.0.css" rel="stylesheet" />
    <link href="/Content/MyDiary_Time/styles.css" rel="stylesheet" />
    <script src="/Content/MyDiary_Time/modernizr.min.js"></script>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">
    <style>
        #fh5co-main {
            overflow-y: auto;
        }
    </style>

</head>
<body id="body">
    <img border='0' src='https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1505677397601&di=1d281c202a3bc8f23682d41d8fa9bd25&imgtype=0&src=http%3A%2F%2Fb.hiphotos.baidu.com%2Fzhidao%2Fpic%2Fitem%2Fdc54564e9258d1094ad836ddd358ccbf6c814da2.jpg' width='100%' height='100%' style='position: absolute;left:0px;top:0px;z-index: -1'>
    <div id="fh5co-main">
        <div class="fh5co-narrow-content">
            <div class="fh5co-heading animate-box" data-animate-effect="fadeInLeft">
                <div style="float: left">Read Our Blog</div>
                <div style="float: right">Read Our Blog</div>
                <div style="clear: both; width: 0px; height: 0px;"></div>
            </div>
            <form class="layui-form layui-form-pane" action="">

                <div class="timeline animated">
                    <div class="timeline-row">
                        <div id="conten">
                            <div class="timeline-time">
                                <small>Oct 30</small>4:53 PM
                            </div>
                            <div class="timeline-icon">
                                <div class="bg-primary">
                                    <i class="fa fa-pencil"></i>
                                </div>
                            </div>
                            <div class="panel timeline-content">
                                <div class="panel-body">

                                    <div class="layui-form-item">
                                        @*<label class="layui-form-label">标题</label>
                                            <div class="layui-input-block">
                                                <input type="text" name="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
                                            </div><br />*@

                                        <div class="layui-inline">
                                            <label class="layui-form-label">选择日期</label>
                                            <div class="layui-input-block">
                                                <input type="text" class="layui-input" id="datetime" placeholder="yyyy-MM-dd HH:mm:ss" value="@DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss")">
                                            </div>
                                        </div>


                                        <textarea class="layui-textarea" id="LAY_demo1" style="display: none" title="小主写点什么吧..."></textarea>
                                        <div class="site-demo-button" style="margin-top: 20px;" align="right">
                                            <a class="layui-btn site-demo-layedit" data-type="text" id="Hold">发布</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div align="center"><a class="layui-btn site-demo-layedit" data-type="text" id="Open">展开写日记</a></div>

                    </div>

                    <div id="content" style="padding-top:20px;">

                    </div>
                    @*<div class="timeline-row">
                            <div class="timeline-time">
                                <small>Oct 30</small>4:53 PM
                            </div>
                            <div class="timeline-icon">
                                <div class="bg-primary">
                                    <i class="fa fa-pencil"></i>
                                </div>
                            </div>
                            <div class="panel timeline-content" style="padding:20px;">
                                    <p>&nbsp; &nbsp; &nbsp; &nbsp;有时候，莫名的心情不好，不想和任何人说话，只想一个人静静的发呆。有时候，夜深人静，突然觉得不是睡不着，而是固执地不想睡。 有时候，听到一首歌，就会突然想起一个人。有时候，别人突然对你说，我觉得你变了，然后自己开始百感交集。丢了的自己，只能慢慢捡回来。</p><p style="text-align: right; "><img src="http://localhost:2459/Content/layui/images/face/48.gif" alt="[伤心]">赵文杰 &nbsp;</p><p style="text-align: right; ">2017-09-08 阴天 &nbsp;</p>
                            </div>
                        </div>*@

                    @*<div class="timeline-row">
                        <div class="timeline-time">
                            <small>2017-09-08</small>6:14
                        </div>
                        <div class="timeline-icon">
                            <div class="bg-warning">
                                <i class="fa fa-quote-right"></i>
                            </div>
                        </div>
                        <div class="panel timeline-content" style="padding:20px;">
                            <p style="text-align: center; "><b>心情<img src="http://localhost:2459/Content/layui/images/face/61.gif" alt="[囧]">日记</b></p><p>有时候，莫名的心情不好，不想和任何人说话，只想一个人静静的发呆。有时候，夜深人静，突然觉得不是睡不着，而是固执地不想睡。 有时候，听到一首歌，就会突然想起一个人。有时候，别人突然对你说，我觉得你变了，然后自己开始百感交集。丢了的自己，只能慢慢捡回来。</p><p style="text-align: right;"><img src="http://localhost:2459/Content/layui/images/face/48.gif" alt="[伤心]">赵文杰 &nbsp;</p><p style="text-align: right;">2017-09-08 阴天&nbsp;</p>*@
                    @*<div class="panel-body">
                            <blockquote>
                                <p>
                                    Lorem ipsum velit ullamco anim pariatur proident eu deserunt laborum. Lorem ipsum ad in nostrud adipisicing cupidatat anim officia ad id cupidatat veniam quis elit ullamco.
                                </p>
                                <small>John Smith</small>
                            </blockquote>
                        </div>*@
                    @*</div>
                        </div>

                        <div class="timeline-row">
                            <div class="timeline-time">
                                <small>Oct 16</small>9:00 AM
                            </div>
                            <div class="timeline-icon">
                                <div class="bg-info">
                                    <i class="fa fa-camera"></i>
                                </div>
                            </div>
                            <div class="panel timeline-content">
                                <div class="panel-body">
                                    <h2>
                                        This is an image posted on my timeline
                                    </h2>
                                    <img class="img-responsive" src="https://lorempixel.com/output/nature-q-c-640-480-10.jpg" />
                                    <p>
                                        Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti.
                                    </p>
                                </div>
                            </div>
                        </div>*@

                    @*<div class="timeline-row">
                            <div class="timeline-time">
                                <small>Oct 12</small>1:14 PM
                            </div>
                            <div class="timeline-icon">
                                <div class="bg-primary">
                                    <i class="fa fa-video-camera"></i>
                                </div>
                            </div>
                            <div class="panel timeline-content">
                                <div class="panel-body">
                                    <h2>
                                        This is a title for this timeline post
                                    </h2>
                                    <div class="video-container">
                                        <iframe allowfullscreen="" frameborder="0" mozallowfullscreen="" src="https://player.vimeo.com/video/16202331?title=0&amp;byline=0&amp;portrait=0" webkitallowfullscreen=""></iframe>
                                    </div>
                                    <p>
                                        Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="timeline-row">
                            <div class="timeline-time">
                                <small>Oct 10</small>4:53 PM
                            </div>
                            <div class="timeline-icon">
                                <div class="bg-primary">
                                    <i class="fa fa-pencil"></i>
                                </div>
                            </div>
                            <div class="panel timeline-content">
                                <div class="panel-body">
                                    <h2>
                                        This is a title for this timeline post
                                    </h2>
                                    <p>
                                        Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti.
                                    </p>
                                </div>
                            </div>
                        </div>*@

                    @*<div class="timeline-row">
                            <div class="timeline-time">
                                <small>Oct 9</small>6:14 PM
                            </div>
                            <div class="timeline-icon">
                                <div class="bg-warning">
                                    <i class="fa fa-quote-right"></i>
                                </div>
                            </div>
                            <div class="panel timeline-content">
                                <div class="panel-body">
                                    <blockquote>
                                        <p>
                                            Lorem ipsum velit ullamco anim pariatur proident eu deserunt laborum. Lorem ipsum ad in nostrud adipisicing cupidatat anim officia ad id cupidatat veniam quis elit ullamco.
                                        </p>
                                        <small>John Smith</small>
                                    </blockquote>
                                </div>
                            </div>
                        </div>*@

                    @*<div class="timeline-row">
                            <div class="timeline-time">
                                <small>Oct 6</small>9:00 AM
                            </div>
                            <div class="timeline-icon">
                                <div class="bg-info">
                                    <i class="fa fa-camera"></i>
                                </div>
                            </div>
                            <div class="panel timeline-content">
                                <div class="panel-body">
                                    <h2>
                                        This is an image posted on my timeline
                                    </h2>
                                    <img class="img-responsive" src="https://lorempixel.com/output/nature-q-c-640-480-10.jpg" />
                                    <p>
                                        Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti.
                                    </p>
                                </div>
                            </div>
                        </div>*@

                    @*<div class="timeline-row">
                            <div class="timeline-time">
                                <small>Oct 2</small>1:14 PM
                            </div>
                            <div class="timeline-icon">
                                <div class="bg-primary">
                                    <i class="fa fa-video-camera"></i>
                                </div>
                            </div>
                            <div class="panel timeline-content">
                                <div class="panel-body">
                                    <h2>
                                        This is a title for this timeline post
                                    </h2>
                                    <div class="video-container">
                                        <iframe src="http://www.56.com/iframe/MTE0MTEwNjc2" width="320" height="270" frameborder="0" allowfullscreen=""></iframe>
                                    </div>
                                    <p>
                                        Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti.
                                    </p>
                                </div>
                            </div>
                        </div>*@

                </div>
            </form>
        </div>
    </div>
    <script src="/Content/MyDiary_Time/main.js"></script>
    <script src="/Content/layui/layui.js"></script>

    <script type="text/javascript">
        var index = 0;
        layui.use(['form', 'layedit', 'laydate'], function () {
            var form = layui.form
                , layer = layui.layer
                , layedit = layui.layedit
                , laydate = layui.laydate;

            layedit.set({
                uploadImage: {
                    url: '/UploadFile/UploadFile' //接口url
                    , type: 'post' //默认post
                }
            });

            //构建一个默认的编辑器
            index = layedit.build('LAY_demo1');

            //时间选择器
            laydate.render({
                elem: '#datetime'
                , type: 'datetime'
            });

            $("#Hold").click(function () {
                alert(layedit.getContent(index)); //获取编辑器内容
                if (layedit.getContent(index) == "" || layedit.getContent(index) == null) {
                    layui.use(['layer'], function () {
                        layer.msg("Sorry，不能插入空的日记哦...", {
                            icon: 1
                        });
                    })
                    return false;
                }
                $.ajax({
                    cache: false,
                    type: "POST",
                    async: false,
                    url: '/MyDiary/MyDiaryAdd?CreateDate=' + $("#datetime").val(),
                    data: { "DiaryContent": layedit.getContent(index) },
                    success: function (data) {
                        ContentShow();
                        res = JSON.parse(data);
                        layui.use(['layer'], function () {
                            layer.msg(res.message, {
                                icon: 1
                            });
                        })
                    }
                })
            })
        });

        $(document).ready(function () {
            //$("li[id='MyDiary']").attr("class", 'fh5co-active')
            //$("li[id!='MyDiary']").attr("class", '')
            // $("li[id='index']").html("<a href=\"/Home/index\">HomePage</a>")
            //$("li[id='Album']").html("<li><a href=\"/Home/Album\">相册</a></li>")
            // $("li[id='Message']").html("<li><a href=\"Message.aspx\">留言板</a></li>")
            // $("li[id='Myvideo']").html("<li><a href=\"/Home/Myvideo\">视频</a></li>")
            // $("li[id='MyDiary']").html("<li id=\"MyDiary\"><a href=\"/MyDiary/MyDiary\">MyDiary</a></li>")
            //$("li[id='Contact']").html("<li><a href=\"/Home/Contact\">关于我们</a></li>")

            ContentShow();
        })



        $("#fh5co-main").height($(window).height());
        window.onresize = function () {
            $("#fh5co-main").height($(window).height());
        }
        var clickcount = 0;
        $('#conten').hide();
        $('#Open').click(function () {
            if (clickcount % 2 == 0)
            { $('#conten').show(500); }
            if (clickcount % 2 != 0)
                $('#conten').hide(500);
            clickcount++;
        })

        function ContentShow() {
            $.ajax({
                cache: false,
                type: "POST",
                async: false,
                url: '/MyDiary/getMyDiaryList',
                success: function (data) {
                    res = JSON.parse(data);
                    $("div[id='content']").empty();
                    var html = "";
                    for (var i = 0; i < res.length; i++) {
                        html += " <div class='timeline-row'>";
                        html += "  <div class='timeline-time'>";
                        html += "    <small>" + res[i].DataYear + "</small>" + res[i].DataTime;
                        html += " </div>";
                        html += "<div class='timeline-icon'>";
                        html += "<div class='bg-primary'>";
                        html += "<i class='fa fa-pencil'></i>";
                        html += "</div>";
                        html += "</div>";
                        html += "<div class='panel timeline-content'>";
                        html += "<i class='layui-icon' style='font-size: 25px; color: #1E9FFF;cursor:pointer;' onclick='DeleteMyDiary(" + res[i].DiaryId + ",this)'>&#xe640;</i>  ";
                        html += "<div style='padding:0px 20px 20px 20px;'>"
                        html += res[i].DiaryContent;
                        html += "</div>";
                        html += "</div>";
                        html += "</div>";
                    }
                    $("div[id='content']").append(html);
                }
            })
        }
        function DeleteMyDiary(DiaryId, obj) {
            $.ajax({
                cache: false,
                type: "POST",
                async: false,
                url: '/MyDiary/MyDiaryDelete',
                data: { "DiaryId": DiaryId },
                success: function (data) {
                    res = JSON.parse(data);
                    layui.use(['layer'], function () {
                        layer.msg(res.message, {
                            icon: 1
                        });
                    })
                    ContentShow();
                }
            })
        }

        $(function () {
            function show() {
                $("#datetime").val(getNowFormatDate())
            }
            setInterval(show, 1000);
        });

        function getNowFormatDate() {

            var date = new Date();

            var seperator1 = "-";

            var seperator2 = ":";

            var month = date.getMonth() + 1;

            var strDate = date.getDate();

            if (month >= 1 && month <= 9) {

                month = "0" + month;

            }

            if (strDate >= 0 && strDate <= 9) {

                strDate = "0" + strDate;

            }

            var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate

                + " " + date.getHours() + seperator2 + date.getMinutes()

                + seperator2 + date.getSeconds();

            return currentdate;

        }
    </script>
</body>
</html>

